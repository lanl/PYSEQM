
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Initialization &#8212; PYSEQM 1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Initialization';</script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="About PYSEQM" href="about.html" />
    <link rel="prev" title="Born Oppenheimer Molecular Dynamics" href="Feature-BOMD.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/PySEQM-Light.png" class="logo__image only-light" alt="PYSEQM 1.0 documentation - Home"/>
    <img src="_static/PySEQM-Light.png" class="logo__image only-dark pst-js-only" alt="PYSEQM 1.0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="quick_start.html">
    Quick Start
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="quick_start.html">
    Quick Start
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="user_guide.html">User Guide</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Feature-SCF.html">SCF Ground State Calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Feature-CIS-RPA.html">CIS Excited State Calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Feature-XLBOMD.html">Extended Lagrangian Born Oppenheimer Molecular Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Feature-BOMD.html">Born Oppenheimer Molecular Dynamics</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Initialization</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About PYSEQM</a></li>

</ul>
</div>
</nav></div>
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="user_guide.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Initialization</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="initialization">
<h1>Initialization<a class="headerlink" href="#initialization" title="Link to this heading">#</a></h1>
<section id="input-formats">
<h2>Input Formats<a class="headerlink" href="#input-formats" title="Link to this heading">#</a></h2>
<p>PySEQM supports input data from PyTorch tensors or <cite>.xyz</cite> files.</p>
<section id="using-pytorch-tensors">
<h3>Using PyTorch Tensors<a class="headerlink" href="#using-pytorch-tensors" title="Link to this heading">#</a></h3>
<p>Each row represents a molecule.</p>
<ul class="simple">
<li><p>species: a tensor containing the atomic numbers (Z) of the atoms in each molecule, ordered from the highest to the lowest atomic number.</p></li>
<li><p>coordinates: a tensor of 3D Cartesian coordinates (x, y, z) for each atom.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">species</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>           <span class="c1"># Molecule 1: O, C, H (padded with 2 zeros)</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>           <span class="c1"># Molecule 2: H2 (padded with 3 zeros)</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>           <span class="c1"># Molecule 3: CH4 (no padding needed)</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

<span class="n">coordinates</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>
    <span class="p">[</span>  <span class="c1"># Molecule 1</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.22</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>  <span class="c1"># padding</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>  <span class="c1"># padding</span>
    <span class="p">],</span>
    <span class="p">[</span>  <span class="c1"># Molecule 2</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.74</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>  <span class="c1"># padding</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>  <span class="c1"># padding</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>  <span class="c1"># padding</span>
    <span class="p">],</span>
    <span class="p">[</span>  <span class="c1"># Molecule 3</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.63</span><span class="p">,</span> <span class="mf">0.63</span><span class="p">,</span> <span class="mf">0.63</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.63</span><span class="p">,</span> <span class="mf">0.63</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.63</span><span class="p">,</span> <span class="mf">0.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.63</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.63</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.63</span><span class="p">],</span>
    <span class="p">],</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="reading-from-xyz-files">
<h3>Reading from <cite>.xyz</cite> Files<a class="headerlink" href="#reading-from-xyz-files" title="Link to this heading">#</a></h3>
<p>PySEQM can also read molecular data directly from <cite>.xyz</cite> files.</p>
<p>An <cite>.xyz</cite> file includes:</p>
<ol class="arabic simple">
<li><p>Number of atoms (first line)</p></li>
<li><p>Comment or title (second line)</p></li>
<li><p>Atom symbol and coordinates per line (x, y, z)</p></li>
</ol>
<p><strong>Example `water.xyz` file</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>3
Water molecule
O    0.000    0.000    0.000
H    0.757    0.586    0.000
H   -0.757    0.586    0.000
</pre></div>
</div>
<p>To read and pad multiple <cite>.xyz</cite> files:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">species</span><span class="p">,</span> <span class="n">coordinates</span> <span class="o">=</span> <span class="n">read_xyz</span><span class="p">([</span>
    <span class="s1">&#39;../../data_one.xyz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;../../data_two.xyz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;../../data_three.xyz&#39;</span>
<span class="p">])</span>
</pre></div>
</div>
</section>
</section>
<section id="padding-for-variable-length-molecules">
<h2>Padding for Variable Length Molecules<a class="headerlink" href="#padding-for-variable-length-molecules" title="Link to this heading">#</a></h2>
<p>To batch molecules of varying sizes, <strong>zero-padding</strong> ensures all tensors have consistent shapes:</p>
<p>All molecules are padded to match the maximum number of atoms in the batch.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">species</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>     <span class="c1"># 2 real atoms, 2 padded</span>
    <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>     <span class="c1"># 4 real atoms</span>
    <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>      <span class="c1"># 3 real atoms, 1 padded</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

<span class="n">coordinates</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.22</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">],</span>  <span class="c1"># padding</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">]</span>   <span class="c1"># padding</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.22</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.20</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.82</span><span class="p">,</span>  <span class="mf">0.94</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.81</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.93</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.23</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.82</span><span class="p">,</span>  <span class="mf">0.94</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">]</span>   <span class="c1"># padding</span>
    <span class="p">]</span>
<span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>Atoms with <code class="docutils literal notranslate"><span class="pre">species</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">coordinates</span> <span class="pre">=</span> <span class="pre">[0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0]</span></code> are ignored in model computation.</p>
</section>
<section id="device-and-gpu-usage">
<h2>Device and GPU Usage<a class="headerlink" href="#device-and-gpu-usage" title="Link to this heading">#</a></h2>
<p>PySEQM supports running on both CPU and GPU. To enable this, set the device automatically:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This ensures that your code will use a GPU if one is available, and fall back to the CPU otherwise.</p>
<p>All tensors and model components should be explicitly moved to the selected device to avoid runtime errors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>When creating new tensors, it’s recommended to specify the device directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="o">...</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>Using a consistent device across all tensors and operations is essential. Operations between tensors on different devices (e.g., one on CPU and one on GPU) will result in errors.</p>
</section>
<section id="precision">
<h2>Precision<a class="headerlink" href="#precision" title="Link to this heading">#</a></h2>
<p>PySEQM requires <strong>double precision</strong> floats (<cite>torch.float64</cite> for floats) to maintain numerical accuracy in electronic structure and molecular dynamics calculations.</p>
<p>Specify the dtype when creating new tensors. For example:</p>
<p>Using lower precision (e.g., <cite>torch.float32</cite>) may result in:</p>
<ul class="simple">
<li><p>Inaccurate energy or force evaluations</p></li>
<li><p>Unstable SCF convergence</p></li>
<li><p>Incorrect gradient behavior in autograd</p></li>
</ul>
</section>
<section id="units">
<h2>Units<a class="headerlink" href="#units" title="Link to this heading">#</a></h2>
<p>The default units used in PySEQM calculations are:</p>
<ul class="simple">
<li><p><strong>Length</strong>: Å (angstroms)</p></li>
<li><p><strong>Energy</strong>: eV (electronvolts)</p></li>
<li><p><strong>Temperature</strong>: K (Kelvin)</p></li>
<li><p><strong>Time</strong>: fs (femtoseconds)</p></li>
<li><p><strong>Force</strong>: eV/Å</p></li>
<li><p><strong>Velocity</strong>: Å/fs</p></li>
</ul>
<p>These units are consistent across all molecular dynamics simulations and electronic structure calculations in PySEQM. Ensure that any input data (e.g., coordinates, velocities) and interpretation of output quantities use the appropriate units.</p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<p><strong>Required for all PySEQM calculations:</strong></p>
<p>These imports provide the core components needed to define molecules and access fundamental physical constants used throughout PySEQM simulations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">seqm.seqm_functions.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">Constants</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">seqm.Molecule</span><span class="w"> </span><span class="kn">import</span> <span class="n">Molecule</span>
</pre></div>
</div>
<p><strong>Required if reading molecular structures from a `.xyz` file:</strong></p>
<p>Use this to load molecular geometries from <cite>.xyz</cite> files, a standard format for storing atomic positions and elements.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">seqm.seqm_functions.read_xyz</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_xyz</span>
</pre></div>
</div>
<p><strong>Required for ground and excited state electronic structure calculations:</strong></p>
<p>This module performs semiempirical quantum mechanical calculations, including total energies, forces, and excited states via methods like CIS.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">seqm.ElectronicStructure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Electronic_Structure</span>
</pre></div>
</div>
<p><strong>Required for basic Molecular Dynamics simulations:</strong></p>
<p>Use this for standard molecular dynamics simulations with basic integration, suitable for energy conservation tests and observing free molecular motion.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">seqm.MolecularDynamics</span><span class="w"> </span><span class="kn">import</span> <span class="n">Molecular_Dynamics_Basic</span>
</pre></div>
</div>
<p><strong>Required for Langevin Thermostat Molecular Dynamics:</strong></p>
<p>Includes stochastic and frictional forces to model interaction with a heat bath, enabling temperature control during simulations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">seqm.MolecularDynamics</span><span class="w"> </span><span class="kn">import</span> <span class="n">Molecular_Dynamics_Basic</span><span class="p">,</span> <span class="n">Molecular_Dynamics_Langevin</span>
</pre></div>
</div>
<p><strong>Required for KSA-XL Born-Oppenheimer Molecular Dynamics:</strong></p>
<p>Implements an efficient Born-Oppenheimer MD scheme using extended Lagrangian and Krylov subspace methods for long, accurate simulations on quantum surfaces.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">seqm.MolecularDynamics</span><span class="w"> </span><span class="kn">import</span> <span class="n">KSA_XL_BOMD</span>
</pre></div>
</div>
</section>
<section id="seqm-parameters">
<span id="id1"></span><h2>SEQM Parameters<a class="headerlink" href="#seqm-parameters" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">seqm_parameters</span></code> dictionary defines settings for a semi-empirical quantum mechanics (SEQM) simulation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">seqm_parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;AM1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;scf_eps&#39;</span><span class="p">:</span> <span class="mf">1.0e-6</span><span class="p">,</span>
    <span class="s1">&#39;scf_converger&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="s1">&#39;sp2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="mf">1.0e-5</span><span class="p">],</span>
    <span class="s1">&#39;learned&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;pair_outer_cutoff&#39;</span><span class="p">:</span> <span class="mf">1.0e10</span><span class="p">,</span>
    <span class="s1">&#39;eig&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<dl>
<dt><strong>method</strong></dt><dd><p>Specifies the semi-empirical method to use.</p>
<dl class="field-list simple">
<dt class="field-odd">type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">accepted values<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">'MNDO'</span></code>, <code class="docutils literal notranslate"><span class="pre">'AM1'</span></code>, <code class="docutils literal notranslate"><span class="pre">'PM3'</span></code>, <code class="docutils literal notranslate"><span class="pre">'PM6'</span></code></p>
</dd>
</dl>
</dd>
<dt><strong>scf_eps</strong></dt><dd><p>Convergence threshold for the SCF (Self-Consistent Field) loop.</p>
<p>The SCF iteration stops when the energy difference between steps is less than this value.</p>
<dl class="field-list simple">
<dt class="field-odd">type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd>
<dt><strong>scf_converger</strong></dt><dd><p>Controls the mixing strategy used in the SCF loop.</p>
<dl class="field-list simple">
<dt class="field-odd">type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p>Accepted formats:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">alpha]</span></code>
Constant linear mixing:
<code class="docutils literal notranslate"><span class="pre">P</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">P_old</span> <span class="pre">+</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">alpha)</span> <span class="pre">*</span> <span class="pre">P_new</span></code>
where <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is the mixing coefficient (e.g., 0.5).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[1]</span></code>
Simple adaptive mixing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">K,</span> <span class="pre">L,</span> <span class="pre">M]</span></code>
Advanced adaptive mixing:</p>
<blockquote>
<div><ul class="simple">
<li><p>Use linear mixing for the first <code class="docutils literal notranslate"><span class="pre">M</span></code> steps.</p></li>
<li><p>Start with mixing coefficient <code class="docutils literal notranslate"><span class="pre">K</span></code> for the first 5 steps.</p></li>
<li><p>Linearly transition from <code class="docutils literal notranslate"><span class="pre">K</span></code> to <code class="docutils literal notranslate"><span class="pre">L</span></code> between steps 6 and <code class="docutils literal notranslate"><span class="pre">M</span></code>.</p></li>
<li><p>After step <code class="docutils literal notranslate"><span class="pre">M</span></code>, switch to adaptive mixing.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">[2]</span></code>
Use adaptive mixing initially, then switch to Pulay mixing.</p></li>
</ul>
</dd>
<dt><strong>sp2</strong></dt><dd><p>Enables special treatment for sp2 hybridized atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">format<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[enabled,</span> <span class="pre">tolerance]</span></code></p>
</dd>
</dl>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code> (bool): Whether to activate sp2 constraints.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tolerance</span></code> (float): Constraint threshold.</p></li>
</ul>
</dd>
<dt><strong>learned</strong></dt><dd><p>Optional parameters for integrating learned models (e.g., using PySEQM with machine learning).</p>
<dl class="field-list simple">
<dt class="field-odd">type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd>
<dt><strong>pair_outer_cutoff</strong></dt><dd><p>Maximum interatomic distance for considering pairwise interactions.</p>
<p>Atoms farther than this cutoff are ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd>
<dt><strong>eig</strong></dt><dd><p>Whether to compute molecular orbitals after SCF convergence.</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the Fock matrix is diagonalized to obtain molecular orbitals.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, only the converged density matrix is computed.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd>
</dl>
</section>
<section id="gpu-computation">
<h2>GPU Computation<a class="headerlink" href="#gpu-computation" title="Link to this heading">#</a></h2>
<p>PySEQM supports GPU acceleration via PyTorch. To enable this, move all tensors and modules to the GPU using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
<span class="n">molecules</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">const</span><span class="p">,</span> <span class="n">seqm_parameters</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">species</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">esdriver</span> <span class="o">=</span> <span class="n">Electronic_Structure</span><span class="p">(</span><span class="n">seqm_parameters</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>Calling <code class="docutils literal notranslate"><span class="pre">.to(device)</span></code> moves data and models to the GPU. All operations will then be performed on the GPU. Mixing CPU and GPU tensors in operations will result in errors.</p>
</section>
<section id="must-be-added-to-run-excited-states">
<h2>Must be added to run Excited States<a class="headerlink" href="#must-be-added-to-run-excited-states" title="Link to this heading">#</a></h2>
<p>For excited state calculations, add the <cite>excited_states</cite> key to your <cite>seqm_parameters</cite> dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">seqm_parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s1">&#39;excited_states&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;n_states&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;rpa&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cis_tolerance&#39;</span><span class="p">:</span> <span class="mf">1e-5</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <cite>excited_states</cite> key takes a dictionary as its value.
This value dictionary should contain the following key/value pairs:
n_states
Number of excited states to compute.</p>
<p><strong>method</strong>
Method used for excited state calculations. Available options:</p>
<ul class="simple">
<li><p><cite>‘rpa’</cite></p></li>
<li><p><cite>‘cis’</cite></p></li>
</ul>
<p>By default it is set to <cite>cis</cite></p>
<p><strong>cis_tolerance</strong></p>
<p>is optional set can be left blank
Convergence criterion for CIS/RPA excited states. By default it is set to 1e-6.</p>
</section>
<section id="must-be-added-to-run-molecular-dynamics">
<h2>Must be added to run Molecular Dynamics<a class="headerlink" href="#must-be-added-to-run-molecular-dynamics" title="Link to this heading">#</a></h2>
<p>The <cite>output</cite> dictionary controls the output settings for Molecular Dynamics (MD) runs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;molid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;thermo&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;dump&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;../../Outputs_location&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">molid<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of molecule IDs to simulate.
Example: <code class="docutils literal notranslate"><span class="pre">[0]</span></code> runs molecule 0.</p>
</dd>
<dt class="field-even">thermo<span class="colon">:</span></dt>
<dd class="field-even"><p>Frequency (in time steps) to print XYZ position information to the screen.
For example, <code class="docutils literal notranslate"><span class="pre">1</span></code> = every timestep, <code class="docutils literal notranslate"><span class="pre">2</span></code> = every other timestep, etc.</p>
</dd>
<dt class="field-odd">dump<span class="colon">:</span></dt>
<dd class="field-odd"><p>Frequency (in time steps) to write XYZ electronic structure trajectory to output files.
Follows the same format as <code class="docutils literal notranslate"><span class="pre">thermo</span></code>.</p>
</dd>
<dt class="field-even">prefix<span class="colon">:</span></dt>
<dd class="field-even"><p>File path prefix for all output files.
Example: <code class="docutils literal notranslate"><span class="pre">'../../Outputs_location'</span></code> saves outputs to the specified directory.</p>
</dd>
</dl>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#input-formats">Input Formats</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-pytorch-tensors">Using PyTorch Tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-from-xyz-files">Reading from <cite>.xyz</cite> Files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#padding-for-variable-length-molecules">Padding for Variable Length Molecules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#device-and-gpu-usage">Device and GPU Usage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#precision">Precision</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#units">Units</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seqm-parameters">SEQM Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gpu-computation">GPU Computation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#must-be-added-to-run-excited-states">Must be added to run Excited States</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#must-be-added-to-run-molecular-dynamics">Must be added to run Molecular Dynamics</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Los Alamos National Laboratory.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>